

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorial: Building conda packages part 2 &mdash; Conda   documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="Conda   documentation" href="../index.html"/>
        <link rel="up" title="Build tutorials" href="../build_tutorials.html"/>
        <link rel="next" title="Tutorial: Building the postgis package" href="postgis.html"/>
        <link rel="prev" title="Tutorial: Basic tutorial for building a Conda package" href="pkgs.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="fa fa-home"> Conda</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#conda-overview">Conda Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#package-naming-conventions">Package Naming Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#meta-packages">Meta-Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#directory-structure">Directory Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#creating-python-3-4-or-python-2-6-environments">Creating Python 3.4 or Python 2.6 environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#update-anaconda-to-latest-version">Update Anaconda to latest version</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../quick-install.html">Quick Install</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quick-install.html#miniconda-quick-install-requirements">Miniconda quick install requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quick-install.html#install-instructions">Install instructions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#silent-installation">Silent installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../test-drive.html">Conda test drive</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../test-drive.html#managing-conda">1. Managing conda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test-drive.html#managing-environments">2. Managing environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test-drive.html#managing-python">3. Managing Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test-drive.html#managing-packages">4. Managing packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test-drive.html#removing-packages-environments-or-conda">5. Removing packages, environments, or conda</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../get-more-help.html">Get more help</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq.html">Conda FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../conda-pip-translator.html">Conda/PIP translator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Conda Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config.html#tab-completion">Tab Completion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build.html">conda build Recipe Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../build.html#the-meta-yaml-file">The meta.yaml file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build.html#environment-variables-set-during-the-build-process">Environment variables set during the build process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build.html#environment-variables-that-affect-the-build-process">Environment variables that affect the build process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build.html#pre-post-link-unlink-scripts">Pre/Post link/unlink scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build.html#post-build-version">Post-build version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build.html#features">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build.html#making-packages-relocatable">Making Packages Relocatable</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../build_tutorials.html">Build tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pkgs.html">Tutorial: Basic tutorial for building a Conda package</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Tutorial: Building conda packages part 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="postgis.html">Tutorial: Building the postgis package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../admin.html">Administrative channel management for a centralized conda installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../admin.html#system-configuration-settings">System configuration settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../admin.html#example-admin-controlled-installation">Example admin-controlled installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../custom-channels.html">Custom Channels</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../custom-channels.html#custom-channel-private-repository-summary">Custom channel/private repository summary</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../commands.html">Command Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../commands.html#general-commands"><tt class="docutils literal"><span class="pre">general-commands</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands.html#env-commands"><tt class="docutils literal"><span class="pre">env-commands</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands.html#build-commands"><tt class="docutils literal"><span class="pre">build-commands</span></tt></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../general-commands.html">General conda commands</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../commands/conda-bundle.html">conda bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/conda-clean.html">conda clean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/conda-config.html">conda config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/conda-create.html">conda create</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/conda-help.html">conda help</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/conda-info.html">conda info</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/conda-init.html">conda init</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/conda-install.html">conda install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/conda-list.html">conda list</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/conda-package.html">conda package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/conda-remove.html">conda remove</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/conda-run.html">conda run</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/conda-search.html">conda search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/conda-uninstall.html">conda uninstall</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/conda-update.html">conda update</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../env-commands.html">conda-env commands</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../commands/env/conda-env.html">conda env</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/env/conda-env-create.html">conda env create</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/env/conda-env-export.html">conda env export</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/env/conda-env-list.html">conda env list</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/env/conda-env-remove.html">conda env remove</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/env/conda-env-update.html">conda env update</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../build-commands.html">conda-build commands</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../commands/build/conda-build.html">conda build</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/build/conda-convert.html">conda convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/build/conda-develop.html">conda develop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/build/conda-index.html">conda index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/build/conda-inspect.html">conda inspect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/build/conda-inspect-linkages.html">conda inspect linkages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/build/conda-inspect-objects.html">conda inspect objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/build/conda-metapackage.html">conda metapackage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/build/conda-pipbuild.html">conda pipbuild</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/build/conda-skeleton.html">conda skeleton</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/build/conda-skeleton-cpan.html">conda skeleton cpan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/build/conda-skeleton-cran.html">conda skeleton cran</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/build/conda-skeleton-pypi.html">conda skeleton pypi</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../spec.html">Conda package specification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec.html#package-metadata">Package metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec.html#link-and-unlink-scripts">Link and unlink scripts:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec.html#repository-structure-and-index">Repository structure and index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec.html#package-match-specifications">Package Match Specifications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../travis.html">Using Conda with Travis CI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../travis.html#the-travis-yml-file">The .travis.yml file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../travis.html#additional-steps">Additional Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../travis.html#building-a-conda-recipe">Building a Conda Recipe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../travis.html#appveyor">AppVeyor</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bdist_conda.html">setup.py bdist_conda</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../bdist_conda.html#notes">Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bdist_conda.html#options">Options</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License - Conda</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../license.html#exceptions">Exceptions</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Conda</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../build_tutorials.html">Build tutorials</a> &raquo;</li>
      
    <li>Tutorial: Building conda packages part 2</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="https://github.com/conda/conda-docs/edit/master/docs/source/build_tutorials/pkgs2.rst" class="fa fa-github"> Edit on GitHub</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="tutorial-building-conda-packages-part-2">
<h1>Tutorial: Building conda packages part 2<a class="headerlink" href="#tutorial-building-conda-packages-part-2" title="Permalink to this headline">¶</a></h1>
<p>This second tutorial is about building a conda package without using the <tt class="docutils literal"><span class="pre">conda</span> <span class="pre">skeleton</span> <span class="pre">pypi</span></tt>
command. In this tutorial we will build the same recipe as in the first tutorial, Pyinstrument, but
this time we will find a similar recipe and edit it to make a new recipe. We also write the recipe
completely from scratch. We also explore the elements of a conda package in more detail.</p>
<p>You should have already completed <a class="reference internal" href="pkgs.html"><em>Tutorial: Basic tutorial for building a Conda package</em></a>.</p>
<div class="section" id="building-conda-packages-summary">
<h2>Building conda packages summary<a class="headerlink" href="#building-conda-packages-summary" title="Permalink to this headline">¶</a></h2>
<p>This tutorial includes the following:</p>
<ol class="arabic simple">
<li><a class="reference internal" href="#before-you-start"><em>Before you start</em></a></li>
<li><a class="reference internal" href="#what-is-a-conda-package"><em>What is a conda package?</em></a></li>
<li><a class="reference internal" href="#about-conda-build-recipe"><em>About conda build recipe</em></a></li>
<li><a class="reference internal" href="#edit-similar-recipe"><em>Edit a similar conda recipe</em></a></li>
<li><a class="reference internal" href="#edit-meta-yaml"><em>Manually edit the file meta.yaml</em></a></li>
<li><a class="reference internal" href="#build-sh-bld-bat"><em>Write the build script files build.sh and bld.bat</em></a></li>
<li><a class="reference internal" href="#build-and-install"><em>Build and install</em></a></li>
<li><a class="reference internal" href="#convert"><em>Convert package for use on all platforms</em></a></li>
<li><a class="reference internal" href="#binstar"><em>Optional: Upload new packages to Binstar.org</em></a></li>
<li><a class="reference internal" href="#more-resources"><em>More resources</em></a></li>
</ol>
<div class="section" id="before-you-start">
<span id="id1"></span><h3>Before you start<a class="headerlink" href="#before-you-start" title="Permalink to this headline">¶</a></h3>
<p>You should already have conda and conda-build by downloading and installing Miniconda or Anaconda.
Conda-build is not automatically installed, so let&#8217;s do that now.</p>
<p>All users install conda-build:</p>
<div class="highlight-bash"><div class="highlight"><pre>conda install conda-build
</pre></div>
</div>
<p>Now you are ready to start building your own conda package.</p>
</div>
<div class="section" id="what-is-a-conda-package">
<span id="id2"></span><h3>What is a conda package?<a class="headerlink" href="#what-is-a-conda-package" title="Permalink to this headline">¶</a></h3>
<p>A conda package is a package that can be installed using the <tt class="docutils literal"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">[packagename]</span></tt> command.</p>
<p>It includes a link to a tarball or bzipped tar archive (.tar.bz2) which contains metadata under the
<tt class="docutils literal"><span class="pre">info/</span></tt> directory, and a collection of files which are installed directly into an <tt class="docutils literal"><span class="pre">install</span></tt> prefix.</p>
<p>The format is identical across platforms and operating systems.  During the install process,
files are extracted into the install prefix, except for files in the <tt class="docutils literal"><span class="pre">info/</span></tt>
directory. Installing the files of a conda package into an environment can be thought of as changing the
directory to an environment, then downloading and extracting the zip file and its dependencies - all with
the single <tt class="docutils literal"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">[packagename]</span></tt> command.</p>
</div>
<div class="section" id="about-conda-build-recipe">
<span id="id3"></span><h3>About conda build recipe<a class="headerlink" href="#about-conda-build-recipe" title="Permalink to this headline">¶</a></h3>
<p>Building a package requires a recipe. A conda build recipe is flat directory which contains the following files:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">meta.yaml</span></tt> contains all the metadata in the recipe. Only package/name and package/version are required fields.</li>
<li><tt class="docutils literal"><span class="pre">build.sh</span></tt>  The Unix script that installs the files for the package on OS X and Linux, and is executed using the bash command.</li>
<li><tt class="docutils literal"><span class="pre">bld.bat</span></tt>  The build script that installs the files for the package on Windows, and is executed using cmd.</li>
<li><tt class="docutils literal"><span class="pre">run_test.py</span></tt> Optional Python test file, a test script that will run automatically if it is part of the recipe.</li>
<li>Optional: patches that will be applied to the source.</li>
<li>Other resources, which are not included in the source and cannot be generated by the build scripts.</li>
</ul>
<p>NOTE: When you use the conda skeleton command, the first three files (<tt class="docutils literal"><span class="pre">meta.yaml</span></tt>, <tt class="docutils literal"><span class="pre">build.sh</span></tt> and <tt class="docutils literal"><span class="pre">bld.bat</span></tt>)
are automatically generated for you. See the previous tutorial <a class="reference internal" href="pkgs.html"><em>Tutorial: Basic tutorial for building a Conda package</em></a> for
more information.</p>
</div>
<div class="section" id="edit-a-similar-conda-recipe">
<span id="edit-similar-recipe"></span><h3>Edit a similar conda recipe<a class="headerlink" href="#edit-a-similar-conda-recipe" title="Permalink to this headline">¶</a></h3>
<p>Now we will create a recipe for the same package that we did in the first tutorial, Pyinstrument. But this
time we will find a similar recipe from from the conda-recipes repo on Github, and manually edit  the values
in the  meta.yaml file.</p>
<p>We will edit a copy of the meta.yaml used in a program named Pyfaker. Despite its name, Pyfaker is a real
Python package that generates fake data for testing. We will edit this file into the meta.yaml file we want
for our new Pyinstrument package.</p>
<p>Let’s start by making a new directory for this tutorial named pyinstrument, and change to the new directory.</p>
<p>All users:</p>
<div class="highlight-bash"><div class="highlight"><pre>mkdir pyinstrument
<span class="nb">cd </span>pyinstrument
</pre></div>
</div>
<p>Now, let’s go get a copy of the Pyfaker’s meta.yaml for us to edit.</p>
<p>In your browser, go to  <a class="reference external" href="https://github.com/conda/conda-recipes/">https://github.com/conda/conda-recipes/</a> .</p>
<p>In the top search box, search for the package named &#8220;pyfaker.&#8221; In the search results, you will see a link to
the <tt class="docutils literal"><span class="pre">pyfaker/meta.yaml</span></tt> file. Open that file.</p>
<p>To save this small file locally, copy its contents, open your favorite text editor, open a new file, and paste its
contents.</p>
<p>Save this new file as <tt class="docutils literal"><span class="pre">meta-pyfaker.yaml</span></tt></p>
<p>Next, remove and replace the Pyfaker information with the 6 fields below.</p>
<p>The fields we want to replace in our pyinstrument script are:</p>
<ol class="arabic simple">
<li>Name: pyinstrument</li>
<li>Git tag: 0.13.1 (or latest from <a class="reference external" href="https://github.com/joerick/pyinstrument/releases">https://github.com/joerick/pyinstrument/releases</a>)</li>
<li>Git URL: <a class="reference external" href="https://github.com/joerick/pyinstrument.git">https://github.com/joerick/pyinstrument.git</a></li>
<li>Imports: pyinstrument</li>
<li>About home: <a class="reference external" href="https://github.com/joerick/pyinstrument">https://github.com/joerick/pyinstrument</a></li>
<li>License: BSD</li>
</ol>
<p>When finished, save to the same directory, this time with the correct name, meta.yaml.
When you are finished, compare your meta .yaml with the answer below:</p>
<div class="highlight-bash"><div class="highlight"><pre>package:
  name: pyfaker pyinstrument

<span class="nb">source</span>:
  git_tag: 0.3.2 0.13.1
  git_url: https://github.com/tpn/faker.git https://github.com/joerick/pyinstrument.git

requirements:
  build:
    - python
    - setuptools

run:
  - python

<span class="nb">test</span>:
  imports:
    - faker pyinstrument

about:
  home: http://www.joke2k.net/faker https://github.com/joerick/pyinstrument
  license: MIT BSD
</pre></div>
</div>
<div class="section" id="how-to-use-pypi-as-the-source-instead-of-github">
<h4>How to use PyPI as the source instead of Github<a class="headerlink" href="#how-to-use-pypi-as-the-source-instead-of-github" title="Permalink to this headline">¶</a></h4>
<p>What if you wanted to use PyPI or another repository instead of Github? There is little difference to conda build
between building from Git versus building from a tarball on a repository like PyPI. Because the same source
is hosted on PyPI and Github, you can easily find a script on  PyPI instead of Github. Simply replace this
“source” section:</p>
<div class="highlight-bash"><div class="highlight"><pre>git_tag: 0.12
git_url: https://github.com/joerick/pyinstrument.git
</pre></div>
</div>
<p>With the following:</p>
<div class="highlight-bash"><div class="highlight"><pre>fn: pyinstrument-0.13.1.tar.gz
md5: e347036acc50720c0903dc2221b2605d
url: https://pypi.python.org/packages/source/p/pyinstrument/pyinstrument-0.13.1.tar.gz
</pre></div>
</div>
<p>Note: The md5 is found on the PyPI Pyinstrument page, <a class="reference external" href="https://pypi.python.org/pypi/pyinstrument">https://pypi.python.org/pypi/pyinstrument</a></p>
</div>
<div class="section" id="more-info-about-the-meta-yaml-file">
<h4>More info about the meta.yaml file<a class="headerlink" href="#more-info-about-the-meta-yaml-file" title="Permalink to this headline">¶</a></h4>
<p>See more information about all the possible values that can go in the meta.yaml file on the
<a class="reference internal" href="../build.html"><em>conda build Recipe Reference</em></a>  page.</p>
</div>
</div>
<div class="section" id="manually-edit-the-file-meta-yaml">
<span id="edit-meta-yaml"></span><h3>Manually edit the file meta.yaml<a class="headerlink" href="#manually-edit-the-file-meta-yaml" title="Permalink to this headline">¶</a></h3>
<p>This time instead of removing and replacing text, we will manually create a new <tt class="docutils literal"><span class="pre">metal.yaml</span></tt> file. If you
want to keep your file from Step 4 above so you can look at it later, rename it something like <tt class="docutils literal"><span class="pre">meta-step4.yaml.</span></tt>
Later when you are finished, you can rename the file meta.yaml.</p>
<p>To create a new meta.yaml file, open your favorite editor. Create a new text file and insert the following
information. A blank sample meta.yaml follows to make it easier to match up the information.</p>
<ol class="arabic simple">
<li>Package name: pyinstrument</li>
<li>Source Git tag: 0.13</li>
<li>Source Git URL: <a class="reference external" href="https://github.com/joerick/pyinstrument.git">https://github.com/joerick/pyinstrument.git</a></li>
<li>Test - Imports: pyinstrument</li>
<li>About home: <a class="reference external" href="https://github.com/joerick/pyinstrument">https://github.com/joerick/pyinstrument</a></li>
<li>About license: BSD</li>
</ol>
<div class="highlight-bash"><div class="highlight"><pre>package:
  name:

  <span class="nb">source</span>:
    git_tag:
    git_url:

requirements:
 build:
   - python
   - setuptools

  run:
   - python

<span class="nb">test</span>:
  imports:
    -

about:
   home:
  license:
</pre></div>
</div>
<p>When you are finished, save the file in the same pyinstrument directory as <tt class="docutils literal"><span class="pre">meta.yaml</span></tt>. Check your work against
the results in Section 4 above.</p>
</div>
<div class="section" id="write-the-build-script-files-build-sh-and-bld-bat">
<span id="build-sh-bld-bat"></span><h3>Write the build script files build.sh and bld.bat<a class="headerlink" href="#write-the-build-script-files-build-sh-and-bld-bat" title="Permalink to this headline">¶</a></h3>
<p>The other two files you need for a build  are</p>
<ul class="simple">
<li><strong>build.sh</strong> shell script for Unix and Mac, and</li>
<li><strong>bld.bat</strong> batch file for Windows.</li>
</ul>
<p>These two build files contain all the variables such as for 32-bit or 64-bit architecture (the ARCH
variable) and the build environment prefix (PREFIX). The two files <tt class="docutils literal"><span class="pre">build.sh</span></tt> and <tt class="docutils literal"><span class="pre">bld.bat</span></tt> files must be
in the same directory as your <tt class="docutils literal"><span class="pre">meta.yaml</span></tt> file.</p>
<p>First, we&#8217;ll write the build file for Linux and Macintosh, then the next file for Windows.
All users, in your favorite text editor, create a new file named <tt class="docutils literal"><span class="pre">build.sh</span></tt> and enter the text exactly as
shown:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">#!/bin/bash                 # This “shebang” tells what program to use to interpret the script.</span>
<span class="nv">$PYTHON</span> setup.py install     <span class="c"># Python command to install the script.</span>
</pre></div>
</div>
<p>That&#8217;s it! Save your new build.sh file to the same directory where you put the meta.yaml file.</p>
<p>Now we’ll write the Windows build script file. All users, still in your favorite text editor, create another
new file named bld.bat and enter the text exactly as shown:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="s2">&quot;%PYTHON%&quot;</span> setup.py install
<span class="k">if</span> errorlevel <span class="m">1</span> <span class="nb">exit </span>1
</pre></div>
</div>
<p>Bld.bat doesn&#8217;t need the shebang, because it only has to work on Windows. But it must be formatted differently,
and needs the command that tells it to exit if it encounters an error.</p>
<p>NOTE: In bld.bat, it is best practices to add the <tt class="docutils literal"><span class="pre">if</span> <span class="pre">errorlevel</span> <span class="pre">1</span> <span class="pre">exit</span> <span class="pre">1</span></tt> so if the build fails,
the command fails.</p>
<p>Save this new file <tt class="docutils literal"><span class="pre">bld.bat</span></tt> to the same directory where you put your new <tt class="docutils literal"><span class="pre">meta.yaml</span></tt> and <tt class="docutils literal"><span class="pre">build.sh</span></tt> files.</p>
<div class="section" id="more-information-on-environment-variables">
<h4>More information on environment variables<a class="headerlink" href="#more-information-on-environment-variables" title="Permalink to this headline">¶</a></h4>
<p>For more information on build files, see <a class="reference internal" href="../build.html"><em>conda build Recipe Reference</em></a></p>
</div>
</div>
<div class="section" id="build-and-install">
<span id="id4"></span><h3>Build and install<a class="headerlink" href="#build-and-install" title="Permalink to this headline">¶</a></h3>
<p>Now that you have your three new build files ready, you are ready to create your new package with
<tt class="docutils literal"><span class="pre">conda</span> <span class="pre">build</span></tt>, and install the package on your local computer.</p>
<p>Run conda build:</p>
<div class="highlight-bash"><div class="highlight"><pre>conda build pyinstrument
</pre></div>
</div>
<p>When conda-build is finished, it displays the filename and the file&#8217;s location at the end of the build.
In our case the file was saved to:</p>
<div class="highlight-bash"><div class="highlight"><pre>~/anaconda/conda-bld/linux-64/pyinstrument-0.13.1-py27_0.tar.bz2
</pre></div>
</div>
<p>NOTE: Save this path and file information for the next step. The exact path and filename will vary depending
on your operating system, and whether you are using Anaconda or Miniconda. Conda-build tells you the exact
location and filename.</p>
<p>Now install your newly-built program on your local computer by using the use-local flag:</p>
<div class="highlight-bash"><div class="highlight"><pre>conda install --use-local pyinstrument
</pre></div>
</div>
<p>We know that Pyinstrument installed successfully if there are no error messages.</p>
</div>
<div class="section" id="convert-package-for-use-on-all-platforms">
<span id="convert"></span><h3>Convert package for use on all platforms<a class="headerlink" href="#convert-package-for-use-on-all-platforms" title="Permalink to this headline">¶</a></h3>
<p>Now that you have built a package for your current platform with conda build, you can convert it for use on
other platforms. This is why you made the two build files, <tt class="docutils literal"><span class="pre">build.sh</span></tt> and <tt class="docutils literal"><span class="pre">bld.bat</span></tt> for all platforms.</p>
<p>Use the conda convert command with a platform specifier from the list
{osx-64,linux-32,linux-64,win-32,win-64,all}. We will use the platform specifier all, as shown:</p>
<div class="highlight-bash"><div class="highlight"><pre>conda convert --platform all ~/anaconda/conda-bld/linux-64/pyinstrument-0.13.1-py27_0.tar.bz2 -o outputdir/
</pre></div>
</div>
<p>Note: change your path and filename to the exact path and filename you saved in Step 7.</p>
</div>
<div class="section" id="optional-upload-new-packages-to-binstar-org">
<span id="binstar"></span><h3>Optional: Upload new packages to Binstar.org<a class="headerlink" href="#optional-upload-new-packages-to-binstar-org" title="Permalink to this headline">¶</a></h3>
<p>After converting your files for use on other platforms, you may choose to upload your files to Binstar.
It only takes a minute to do if you have a free Binstar.org account.</p>
<p>If you haven’t already, open a free Binstar.org account and record your new binstar username and password.</p>
<p>Next, in your terminal window, run <tt class="docutils literal"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">binstar</span></tt> and enter your new binstar username and password.</p>
<p>Again in your terminal window, log into your binstar.org account with the command:</p>
<div class="highlight-bash"><div class="highlight"><pre>binstar login
</pre></div>
</div>
<p>And upload your package to Binstar:</p>
<div class="highlight-bash"><div class="highlight"><pre>binstar upload ~/miniconda/conda-bld/linux-64/pyinstrument-0.12-py27_0.tar.bz
</pre></div>
</div>
<p>NOTE: Change your path and filename to the exact path and filename you saved in Step 7.</p>
<p>TIP: To save time, you can set conda to always automatically upload a successful build to Binstar
with the command: <tt class="docutils literal"><span class="pre">conda</span> <span class="pre">config</span> <span class="pre">--set</span> <span class="pre">binstar_upload</span> <span class="pre">yes</span></tt></p>
</div>
<div class="section" id="more-resources">
<span id="id5"></span><h3>More resources<a class="headerlink" href="#more-resources" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../build.html"><em>conda build Recipe Reference</em></a></p>
<p><a class="reference internal" href="../build-commands.html"><em>conda-build commands</em></a></p>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="postgis.html" class="btn btn-neutral float-right" title="Tutorial: Building the postgis package">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pkgs.html" class="btn btn-neutral" title="Tutorial: Basic tutorial for building a Conda package"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Continuum Analytics.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:' ',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-27761864-11', 'auto');
  ga('send', 'pageview');

</script>


</body>
</html>